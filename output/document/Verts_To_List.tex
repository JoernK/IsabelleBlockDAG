%
\begin{isabellebody}%
\setisabellecontext{Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List\isanewline
\ \ \isakeyword{imports}\ Utils\ blockDAG\ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Comparator{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
Function to sort a list $L$ under a graph G such if $a$ references $b$,
$b$ precedes $a$ in the list%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ unfold{\isacharunderscore}{\kern0pt}referencing{\isacharunderscore}{\kern0pt}verts{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}unfold{\isacharunderscore}{\kern0pt}referencing{\isacharunderscore}{\kern0pt}verts\ G\ a\ {\isacharequal}{\kern0pt}\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}b\ {\isasymin}\ verts\ G{\isachardot}{\kern0pt}\ dominates\ G\ b\ a{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List{\isacharunderscore}{\kern0pt}Rec{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List{\isacharunderscore}{\kern0pt}Rec\ G\ L\ c\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}c\ {\isasymle}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ then\ L\ else\ Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List{\isacharunderscore}{\kern0pt}Rec\ G\ {\isacharparenleft}{\kern0pt}foldr\ {\isacharparenleft}{\kern0pt}{\isacharat}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}referencing{\isacharunderscore}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ L{\isacharparenright}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}c\ {\isacharminus}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \isanewline
\isacommand{fun}\isamarkupfalse%
\ Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ list{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List\ G\ {\isacharequal}{\kern0pt}\ remdups\ {\isacharparenleft}{\kern0pt}Verts{\isacharunderscore}{\kern0pt}To{\isacharunderscore}{\kern0pt}List{\isacharunderscore}{\kern0pt}Rec\ G\ {\isacharbrackleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}arcs\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=/cygdrive/c/DAGModelling/Isabelle/Verts_To_List.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%22=6%:%
%:%23=7%:%
%:%25=9%:%
%:%26=9%:%
%:%27=10%:%
%:%28=11%:%
%:%29=12%:%
%:%30=12%:%
%:%31=13%:%
%:%32=14%:%
%:%33=15%:%
%:%34=16%:%
%:%35=16%:%
%:%36=17%:%
%:%37=18%:%
%:%40=19%:%
%:%45=20%:%