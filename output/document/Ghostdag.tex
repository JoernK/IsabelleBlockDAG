%
\begin{isabellebody}%
\setisabellecontext{Ghostdag}%
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Ghostdag\ \ \isanewline
\ \ \isakeyword{imports}\ blockDAG\ Utils\ TopSort\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{GHOSTDAG%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
Based on the GHOSTDAG blockDAG consensus algorithmus by Sompolinsky and Zohar 2018%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Funcitions and Definitions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{fun}\isamarkupfalse%
\ kCluster{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set\ \ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ \ {\isachardoublequoteopen}kCluster\ G\ k\ C\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}C\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ then\ {\isacharparenleft}{\kern0pt}{\isasymforall}a\ {\isasymin}\ C{\isachardot}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}anticone\ G\ a{\isacharparenright}{\kern0pt}\ {\isasyminter}\ C{\isacharparenright}{\kern0pt}\ {\isasymle}\ k{\isacharparenright}{\kern0pt}\ else\ False{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ max{\isacharunderscore}{\kern0pt}kCluster{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ \ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ set{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}max{\isacharunderscore}{\kern0pt}kCluster\ G\ k\ {\isacharequal}{\kern0pt}\ arg{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}on\ card\ {\isacharbraceleft}{\kern0pt}C\ {\isasymin}\ {\isacharparenleft}{\kern0pt}Pow\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ kCluster\ G\ k\ C{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sub{\isacharunderscore}{\kern0pt}kCluster{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}kCluster\ G\ k\ C{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}finite\ C{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{and}\ {\isachardoublequoteopen}C{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ C{\isachardoublequoteclose}\ \ \isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}kCluster\ G\ k\ C{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}C\ {\isasymsubseteq}\ verts\ G{\isachardoublequoteclose}\ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{unfolding}\isamarkupfalse%
\ kCluster{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ metis\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ C{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}sub{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}C{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ verts\ G{\isachardoublequoteclose}\ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}a{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}anticone\ G\ a\ {\isasyminter}\ C{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}anticone\ G\ a\ {\isasyminter}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymAnd}a{\isachardot}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}anticone\ G\ a\ {\isasyminter}\ C{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}anticone\ G\ a\ {\isasyminter}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}mono\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}Int\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ C{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}sub\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ order{\isachardot}{\kern0pt}trans\ subset{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ \ kCluster{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\ \ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}\isakeyword{in}\ blockDAG{\isacharparenright}{\kern0pt}\ \ reduce{\isacharunderscore}{\kern0pt}kCluster{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}kCluster\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ a{\isacharparenright}{\kern0pt}\ k\ C{\isachardoublequoteclose}\isanewline
\isakeyword{shows}\ {\isachardoublequoteopen}kCluster\ G\ k\ C{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ kCluster{\isachardot}{\kern0pt}simps\ \isacommand{sorry}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Function to compare the size of set and break ties. Used for the GHOSTDAG maximum blue 
      cluster selection%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}\ \ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple\ A\ B\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fst\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fst\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymor}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fst\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymge}\ card\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fst\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ snd\ A\ {\isasymle}\ snd\ B{\isacharparenright}{\kern0pt}\ then\ A\ else\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Function to add node $a$ to a tuple of a set S and List L%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}\ \ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}S\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ L\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Function that adds a node $a$ to a kCluster $S$, if $S + {a}$ remains a kCluster.
    Also adds $a$ to the end of list $L$%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}\isanewline
\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}kCluster\ G\ k\ {\isacharparenleft}{\kern0pt}S\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
then\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}a{\isacharparenright}{\kern0pt}\ else\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Function to select the largest $((S,L),a)$ according to $larger-blue-tuple$%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ list\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ L\ {\isacharequal}{\kern0pt}\ fold\ {\isacharparenleft}{\kern0pt}larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple{\isacharparenright}{\kern0pt}\ L\ {\isacharparenleft}{\kern0pt}hd\ L{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
GHOSTDAG ordering algorithm%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{function}\isamarkupfalse%
\ OrderDAG\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a\ set\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ list{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{where}\isanewline
\ \ \ \ {\isachardoublequoteopen}OrderDAG\ G\ k\ {\isacharequal}{\kern0pt}\ \ \isanewline
\ \ {\isacharparenleft}{\kern0pt}if\ {\isacharparenleft}{\kern0pt}{\isasymnot}\ blockDAG\ G{\isacharparenright}{\kern0pt}\ then\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ else\ \isanewline
\ \ if\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isacharparenright}{\kern0pt}\ \ then\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}{\isacharbrackleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ else\isanewline
\ let\ M\ {\isacharequal}{\kern0pt}\ \ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ in\ fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{termination}\isamarkupfalse%
%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}R\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}measure\ {\isacharparenleft}{\kern0pt}\ {\isasymlambda}{\isacharparenleft}{\kern0pt}G{\isacharcomma}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ G{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph{\isachardoublequoteclose}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ k{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}nat\ \isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ bD{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}{\isasymnot}\ {\isasymnot}\ blockDAG\ G{\isachardoublequoteclose}\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ bD\ blockDAG{\isachardot}{\kern0pt}blockDAG{\isacharunderscore}{\kern0pt}size{\isacharunderscore}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ nT{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ tips\ G{\isachardot}{\kern0pt}\ {\isasymnot}\ blockDAG{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}node\ G\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}unequal{\isacharunderscore}{\kern0pt}gen\ bD\ tips{\isacharunderscore}{\kern0pt}def\ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}\ x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}t{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ bD\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ card{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff\ length{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}set\ length{\isacharunderscore}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ set{\isacharunderscore}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ x{\isacharcomma}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ G{\isacharcomma}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isasymin}\ measure\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}G{\isacharcomma}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}less\ bD\ tips{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}tip{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Creating a relation on verts $G$ based on the GHOSTDAG OrderDAG algorithm%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ GHOSTDAG\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}linorder{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}b{\isacharparenright}{\kern0pt}\ pre{\isacharunderscore}{\kern0pt}digraph\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rel{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{where}\ {\isachardoublequoteopen}GHOSTDAG\ k\ G\ {\isacharequal}{\kern0pt}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Soundness%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ OrderDAG{\isacharunderscore}{\kern0pt}casesAlt{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{obtains}\ {\isacharparenleft}{\kern0pt}ntB{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ blockDAG\ G{\isachardoublequoteclose}\ \isanewline
\ \ {\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G\ {\isasymand}\ card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ {\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}more{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G\ {\isasymand}\ card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ \ blockDAG{\isachardot}{\kern0pt}blockDAG{\isacharunderscore}{\kern0pt}size{\isacharunderscore}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Soundness of the $add-set-list$ function%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ L\ {\isasymsubseteq}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ set\ L\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}mono{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ S\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}length{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Suc\ {\isacharparenleft}{\kern0pt}length\ L{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Soundness of the $add-if-blue$ function%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ \ card{\isacharunderscore}{\kern0pt}mono\ subset{\isacharunderscore}{\kern0pt}insertI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ subsetI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}append{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}a\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}\ {\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}mono{\isadigit{3}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ set\ L\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ subsetI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}mono{\isadigit{4}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ L{\isadigit{1}}\ {\isasymsubseteq}\ set\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isasymsubseteq}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isadigit{2}}{\isacharcomma}{\kern0pt}L{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ S{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ card\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ card{\isacharunderscore}{\kern0pt}mono\ subset{\isacharunderscore}{\kern0pt}insertI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isacharunderscore}{\kern0pt}length{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Suc\ {\isacharparenleft}{\kern0pt}length\ \ L{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ L{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Soundness of the $larger-blue-tuple$ comparison%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}fst\ V{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ V{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}V{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ V{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}b{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}card{\isacharunderscore}{\kern0pt}mono\ larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ eq{\isacharunderscore}{\kern0pt}refl\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fst{\isacharunderscore}{\kern0pt}conv\ prod{\isachardot}{\kern0pt}collapse\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}subs{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple\ A\ B\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}A{\isacharcomma}{\kern0pt}B{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}%
\isadelimproof
\ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Soundness of the $choose_max_blue_set$ function%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}avoid{\isacharunderscore}{\kern0pt}empty{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}L\ {\isasymnoteq}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ L\ {\isasymin}\ set\ L{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set{\isachardot}{\kern0pt}simps\ \isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ fold{\isacharunderscore}{\kern0pt}invariant{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isasymAnd}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ set\ L\ {\isasymLongrightarrow}\ x\ {\isasymin}\ set\ L{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}hd\ L\ {\isasymin}\ set\ L{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\ \isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ s\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ L{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}s\ {\isasymin}\ set\ L{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple\ x\ s\ {\isasymin}\ set\ L{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ larger{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{Auxiliary lemmas for OrderDAG%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}length{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}length\ {\isacharparenleft}{\kern0pt}snd\ \ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ \isanewline
\ \ L{\isadigit{1}}\ PL{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ length\ L{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ length\ {\isacharparenleft}{\kern0pt}snd\ PL{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isadigit{1}}\ arbitrary{\isacharcolon}{\kern0pt}\ PL{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}Cons\ comp{\isacharunderscore}{\kern0pt}apply\ \isacommand{using}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isacharunderscore}{\kern0pt}length\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ add{\isacharunderscore}{\kern0pt}Suc\ add{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}right\ length{\isacharunderscore}{\kern0pt}Cons\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}exhaust\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L{\isadigit{1}}\ {\isacharat}{\kern0pt}\ L{\isadigit{2}}\ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isadigit{2}}\ arbitrary{\isacharcolon}{\kern0pt}\ S\ L{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{using}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}\ x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isadigit{2}}{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Cons{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}appendI\ append{\isachardot}{\kern0pt}assoc\ assms\ in{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}decomp\ sndI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isadigit{3}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}set\ L{\isadigit{1}}\ {\isasymsubseteq}\ set\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L\ {\isacharparenleft}{\kern0pt}S{\isadigit{1}}{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isasymsubseteq}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L\ {\isacharparenleft}{\kern0pt}S{\isadigit{2}}{\isacharcomma}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}ex{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}set\ L{\isadigit{2}}\ {\isasymunion}\ set\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}sub{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}\ S\ {\isasymsubseteq}\ \ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isadigit{2}}\ arbitrary{\isacharcolon}{\kern0pt}\ S\ L{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{consider}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}S\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Cons{\isachardot}{\kern0pt}hyps\ Un{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}right\ Un{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}right\ fold{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ insert{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}sub{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ set\ L{\isadigit{2}}\ {\isasymunion}\ S{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isadigit{2}}\ arbitrary{\isacharcolon}{\kern0pt}\ S\ L{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{consider}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}S\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{using}\isamarkupfalse%
\ Cons\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Un{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}right\ Un{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}left\ Un{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}right\ fold{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}supI{\isadigit{1}}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}fst{\isacharunderscore}{\kern0pt}kCluster{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}kCluster\ G\ k\ S{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}kCluster\ G\ k\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isadigit{2}}\ arbitrary{\isacharcolon}{\kern0pt}\ S\ L{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{consider}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}S\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isacharbar}{\kern0pt}\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k\ a\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}\ L{\isadigit{1}}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{unfolding}\isamarkupfalse%
\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Cons{\isachardot}{\kern0pt}hyps\ Cons{\isachardot}{\kern0pt}prems\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\ fold{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}rel{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ L{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isadigit{2}}\ arbitrary{\isacharcolon}{\kern0pt}\ S\ L{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}apply\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}mono\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ prod{\isachardot}{\kern0pt}collapse\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}rel{\isadigit{2}}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}rel{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ L{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}y{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ L{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}S{\isacharcomma}{\kern0pt}L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isadigit{2}}\ arbitrary{\isacharcolon}{\kern0pt}\ S\ L{\isadigit{1}}{\isacharcomma}{\kern0pt}\ simp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ fold{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ comp{\isacharunderscore}{\kern0pt}apply\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}append\ app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Un{\isacharunderscore}{\kern0pt}iff\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}rel\ set{\isacharunderscore}{\kern0pt}ConsD\ set{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}\ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}tip{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}\ x\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{interpret}\isamarkupfalse%
\ bD{\isacharcolon}{\kern0pt}\ blockDAG\ \isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ pp\ \isakeyword{where}\ pp{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pp\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}exist\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mm{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp\ {\isasymin}\ set\ pp{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}avoid{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ \ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}finite\ \isanewline
\ \ \ \ \ \ list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}iff\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Nil{\isacharunderscore}{\kern0pt}iff\ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ kk{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ \ snd\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mm{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}L{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}map\ snd\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}\ {\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ L{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \ L{\isachardoublequoteclose}\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{fix}\isamarkupfalse%
\ L\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}map\ snd\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ L{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ a\ L{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ snd\ pp{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ mm{\isadigit{2}}\ pp{\isacharunderscore}{\kern0pt}in\ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ kk\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}finite\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ kk\ assms\ pp{\isacharunderscore}{\kern0pt}in\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}\ x\ {\isasymin}\ set\ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}P\ i{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ L{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}fst\ x\ {\isacharequal}{\kern0pt}\ P\ {\isacharparenleft}{\kern0pt}snd\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ L{\isacharcomma}{\kern0pt}\ auto{\isacharparenright}{\kern0pt}\ \isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ \ {\isachardoublequoteopen}snd\ \ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isakeyword{and}\ \ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ snd\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x\ {\isasymin}\ set\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymnot}\ blockDAG{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}node\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\isanewline
\ \ blockDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\ \isanewline
\ \ \isacommand{interpret}\isamarkupfalse%
\ bD{\isacharcolon}{\kern0pt}\ blockDAG\ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ pp\ \isakeyword{where}\ pp{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pp\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}exist\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ mm{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp\ {\isasymin}\ set\ pp{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}avoid{\isacharunderscore}{\kern0pt}empty\isanewline
\ \ \ \ \ \ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}finite\isanewline
\ \ \ \ \ \ list{\isachardot}{\kern0pt}map{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}iff\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Nil{\isacharunderscore}{\kern0pt}iff\ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ kk{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ \ snd\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ seteq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ snd\ pp{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}map\ pp{\isacharunderscore}{\kern0pt}in\ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ kk\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ tip{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}finite\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ kk\ pp{\isacharunderscore}{\kern0pt}in\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}map\ snd\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ map{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}map\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x\ {\isasymin}\ set\ x{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ seteq\ pp{\isacharunderscore}{\kern0pt}in\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ mm\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isadigit{1}}\ mm\ pp{\isacharunderscore}{\kern0pt}in{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ blockDAG{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}node\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\ blockDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ tip\ bD{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past{\isacharunderscore}{\kern0pt}dagbased\ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts\ subsetD\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\ \ \ \ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsubsection{OrderDAG soundness%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ Verts{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}OrderDAG{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ G\ k\ \ arbitrary{\isacharcolon}{\kern0pt}\ x\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ G\ k\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ bD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ G{\isachardoublequoteclose}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cD{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}cDm{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cD{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ OrderDAG{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}in\ bD\ cD{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ genesis{\isacharunderscore}{\kern0pt}nodeAlt{\isacharunderscore}{\kern0pt}sound\ blockDAG{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}node{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ card{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}singletonE\ singletonD{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cDm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ pp\ \isakeyword{where}\ pp{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pp\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}exist\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ tt{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps\ bD\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \ \ \isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ bD\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ tt{\isadigit{2}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}in\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ as{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ fCur\ \isakeyword{where}\ fcur{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}fCur\ {\isacharequal}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd{\isacharparenleft}{\kern0pt}fCur{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ as{\isadigit{1}}\ \isacommand{using}\isamarkupfalse%
\ \ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ fcur{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}cases\ snd{\isacharunderscore}{\kern0pt}conv\ insertI{\isadigit{1}}\ snd{\isacharunderscore}{\kern0pt}conv\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ hide{\isacharunderscore}{\kern0pt}lams{\isacharparenright}{\kern0pt}\ Un{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}right\ fst{\isacharunderscore}{\kern0pt}conv\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ set{\isacharunderscore}{\kern0pt}append{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fCur{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}\ surj{\isacharunderscore}{\kern0pt}pair\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ fcur{\isacharunderscore}{\kern0pt}in\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ OrderDAG{\isachardot}{\kern0pt}simps\ cDm\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ anti{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ ttt\ \isakeyword{where}\ ttt{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ttt\ {\isacharequal}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ttt{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ anti\ bD\ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ DAG{\isachardot}{\kern0pt}anticon{\isacharunderscore}{\kern0pt}finite\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}\ surj{\isacharunderscore}{\kern0pt}pair\ top{\isacharunderscore}{\kern0pt}sort{\isacharunderscore}{\kern0pt}con\ \ \isacommand{by}\isamarkupfalse%
\ metis\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ pp{\isacharunderscore}{\kern0pt}in\ bD\ cDm\ ttt{\isacharunderscore}{\kern0pt}in\ {\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ \ as{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ pas{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ reduce{\isacharunderscore}{\kern0pt}past{\isachardot}{\kern0pt}simps\ induce{\isacharunderscore}{\kern0pt}subgraph{\isacharunderscore}{\kern0pt}verts\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ cd{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ cDm\ bD\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}blockDAG{\isacharunderscore}{\kern0pt}size{\isacharunderscore}{\kern0pt}cases\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ tt{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ digraph{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}finite\ bD\ subs\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}blockDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ blockDAG{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past{\isacharunderscore}{\kern0pt}dagbased\ bD\ tt{\isadigit{2}}\ \ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}unequal{\isacharunderscore}{\kern0pt}gen\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ cd{\isadigit{1}}\ tips{\isacharunderscore}{\kern0pt}def\ CollectD\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ bass{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ pp{\isacharunderscore}{\kern0pt}in\ {\isadigit{1}}\ cDm\ tt{\isadigit{2}}\ pas\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ in{\isacharunderscore}{\kern0pt}F{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}in\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ bD\ \isacommand{by}\isamarkupfalse%
\ fastforce\ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}fst{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}\ in{\isacharunderscore}{\kern0pt}F\ prod{\isachardot}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}OrderDAG\ G\ k\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ cDm\ {\isadigit{1}}\ OrderDAG{\isachardot}{\kern0pt}simps\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ map{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}mono\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ in{\isacharunderscore}{\kern0pt}F\ prod{\isachardot}{\kern0pt}collapse\ subset{\isacharunderscore}{\kern0pt}code{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ OrderDAG{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ G{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induction\ G\ k\ arbitrary{\isacharcolon}{\kern0pt}\ x\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ G\ k\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}inval{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ blockDAG\ G{\isachardoublequoteclose}{\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}one{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G\ {\isasymand}\isanewline
\ \ card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}val{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G\ {\isasymand}\isanewline
\ \ card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ inval\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ one\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ {\isadigit{1}}\ genesis{\isacharunderscore}{\kern0pt}nodeAlt{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}sound\ blockDAG{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}node{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ empty{\isacharunderscore}{\kern0pt}set\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ singleton{\isacharunderscore}{\kern0pt}iff\ sndI\ \isacommand{by}\isamarkupfalse%
\ fastforce\ \ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ val\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ bD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ val\ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ M\ \isakeyword{where}\ M{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}M\ {\isacharequal}{\kern0pt}\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ pp\ \isakeyword{where}\ pp{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pp\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}exist\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ \ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}in\ val\ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ val\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ {\isacharequal}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}ex\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eq{\isacharunderscore}{\kern0pt}snd{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}ac{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}co{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ G{\isachardoublequoteclose}\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ ac\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ top{\isacharunderscore}{\kern0pt}sort{\isacharunderscore}{\kern0pt}con\ DAG{\isachardot}{\kern0pt}anticone{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts\ val\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ DAG{\isachardot}{\kern0pt}anticon{\isacharunderscore}{\kern0pt}finite\ subsetD{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ co\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}ma{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ snd\ M{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}nma{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd{\isacharparenleft}{\kern0pt}\ fst{\isacharparenleft}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Un{\isacharunderscore}{\kern0pt}insert{\isacharunderscore}{\kern0pt}right\ append{\isacharunderscore}{\kern0pt}Nil{\isadigit{2}}\ insertE\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ prod{\isachardot}{\kern0pt}collapse\ set{\isacharunderscore}{\kern0pt}append\ sndI{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ ma\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}in\ \ \isacommand{using}\isamarkupfalse%
\ bD\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ digraph{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts\ subs\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ mm{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp\ {\isasymin}\ set\ pp{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ \isacommand{using}\isamarkupfalse%
\ bD\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Nil{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}conv\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}avoid{\isacharunderscore}{\kern0pt}empty{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ nma\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ M{\isacharunderscore}{\kern0pt}in\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}avoid{\isacharunderscore}{\kern0pt}empty\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}empty\ bD\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ ex{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}conv\ fst{\isacharunderscore}{\kern0pt}conv\ mm\ pp{\isacharunderscore}{\kern0pt}in\ snd{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ val\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps\ M{\isacharunderscore}{\kern0pt}in\ pp{\isacharunderscore}{\kern0pt}in\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ digraph{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}finite\ subs\ bD\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ verts\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ reduce{\isacharunderscore}{\kern0pt}past{\isachardot}{\kern0pt}simps\ induce{\isacharunderscore}{\kern0pt}subgraph{\isacharunderscore}{\kern0pt}verts\ past{\isacharunderscore}{\kern0pt}nodes{\isachardot}{\kern0pt}simps\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\ \isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ OrderDAG{\isacharunderscore}{\kern0pt}length{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}blockDAG\ G\ {\isasymLongrightarrow}\ length\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ G\ k\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ G\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isacharunderscore}{\kern0pt}casesAlt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ ntB\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ one\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ more\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ bD{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ ma\ \isakeyword{where}\ pp{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ma\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ backw{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}OrderDAG\ G\ k\ {\isacharequal}{\kern0pt}\ fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ ma{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ pp{\isacharunderscore}{\kern0pt}in\ more\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}extra{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ tt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ ma\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ chosen{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}tip\ \isanewline
\ \ \ \ \ \ \ \ \ \ more\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ ttt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ ma\ {\isasymin}\ tips\ G{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}tip{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \ \ more\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ bD{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}unequal{\isacharunderscore}{\kern0pt}gen\ bD\ more\ \isanewline
\ \ \ \ \ \ \ \ \ \ blockDAG{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past{\isacharunderscore}{\kern0pt}dagbased\ bD\ tips{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ tt\ bD{\isadigit{2}}\ more\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fst\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ bD\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\ \ \isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharplus}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}verts\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}length\ plus{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Suc\ prod{\isachardot}{\kern0pt}collapse{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ backw\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ DAG{\isachardot}{\kern0pt}verts{\isacharunderscore}{\kern0pt}size{\isacharunderscore}{\kern0pt}comp\ ttt\isanewline
\ \ \ \ \ \ \ \ \ \ add{\isachardot}{\kern0pt}assoc\ add{\isachardot}{\kern0pt}commute\ bD\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}length\ length{\isacharunderscore}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ top{\isacharunderscore}{\kern0pt}sort{\isacharunderscore}{\kern0pt}len\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}full{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \ \isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ OrderDAG{\isacharunderscore}{\kern0pt}total{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ verts\ G{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ Verts{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}OrderDAG\ OrderDAG{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ \ OrderDAG{\isacharunderscore}{\kern0pt}distinct{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}distinct\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ OrderDAG{\isacharunderscore}{\kern0pt}length\ OrderDAG{\isacharunderscore}{\kern0pt}total\isanewline
\ \ \ \ card{\isacharunderscore}{\kern0pt}distinct\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ OrderDAG{\isacharunderscore}{\kern0pt}kCluster{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}kCluster\ G\ k\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ G\ k\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ G\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isacharunderscore}{\kern0pt}casesAlt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ ntB\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ one\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ fsG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ aG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ sG{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ {\isacharbraceleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbraceright}{\kern0pt}\ {\isasymsubseteq}\ verts\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}safe{\isacharcomma}{\kern0pt}\ metis\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ genesis{\isacharunderscore}{\kern0pt}nodeAlt{\isacharunderscore}{\kern0pt}vert{\isacharparenright}{\kern0pt}\ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ \ ttt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}thesis\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharparenright}{\kern0pt}\ {\isasyminter}\ {\isacharbraceleft}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}nodeAlt\ G{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ kCluster{\isachardot}{\kern0pt}simps\ fsG\ \isacommand{using}\isamarkupfalse%
\ sG\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ \ ttt\ aG\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ more\isanewline
\ \ \ \ \isacommand{interpret}\isamarkupfalse%
\ bD{\isacharcolon}{\kern0pt}\ blockDAG\ G\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ ma\ \isakeyword{where}\ pp{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ma\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ backw{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}OrderDAG\ G\ k\ {\isacharequal}{\kern0pt}\ fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ ma{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ pp{\isacharunderscore}{\kern0pt}in\ more\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}extra{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ tt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}snd\ ma\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bD{\isachardot}{\kern0pt}blockDAG{\isacharunderscore}{\kern0pt}axioms\ \isacommand{unfolding}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ bD{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}node\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}finite\ \isanewline
\ \ \ \ bD{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}unequal{\isacharunderscore}{\kern0pt}gen\ more\ tips{\isacharunderscore}{\kern0pt}tips\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ bDR{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}\ bD{\isachardot}{\kern0pt}blockDAG{\isacharunderscore}{\kern0pt}axioms\ \isacommand{unfolding}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ kBase{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}kCluster\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ tt\ {\isadigit{1}}\ more\ \ bD{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}kCluster\ nat{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}iff\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ fff{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fst\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ bD{\isachardot}{\kern0pt}blockDAG{\isacharunderscore}{\kern0pt}axioms\ \isacommand{unfolding}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\ \ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}kCluster\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ {\isacharparenleft}{\kern0pt}snd\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ k\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}fst\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ kBase\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ fff\ pp{\isacharunderscore}{\kern0pt}in\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{sorry}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=/cygdrive/c/DAGModelling/Isabelle/Ghostdag.thy%:%
%:%6=1%:%
%:%11=2%:%
%:%12=2%:%
%:%13=3%:%
%:%14=4%:%
%:%28=6%:%
%:%40=7%:%
%:%49=10%:%
%:%59=12%:%
%:%60=12%:%
%:%61=13%:%
%:%62=14%:%
%:%63=15%:%
%:%64=16%:%
%:%65=16%:%
%:%66=17%:%
%:%67=18%:%
%:%68=19%:%
%:%69=20%:%
%:%70=20%:%
%:%71=21%:%
%:%72=22%:%
%:%73=23%:%
%:%74=24%:%
%:%81=25%:%
%:%82=25%:%
%:%83=26%:%
%:%84=26%:%
%:%85=26%:%
%:%86=26%:%
%:%87=26%:%
%:%88=27%:%
%:%89=27%:%
%:%90=27%:%
%:%91=27%:%
%:%92=27%:%
%:%93=28%:%
%:%94=28%:%
%:%95=28%:%
%:%96=29%:%
%:%97=29%:%
%:%98=30%:%
%:%99=30%:%
%:%100=30%:%
%:%101=31%:%
%:%102=31%:%
%:%103=32%:%
%:%104=32%:%
%:%105=33%:%
%:%106=33%:%
%:%107=33%:%
%:%108=33%:%
%:%109=34%:%
%:%110=34%:%
%:%111=35%:%
%:%112=35%:%
%:%113=36%:%
%:%119=36%:%
%:%122=37%:%
%:%123=38%:%
%:%124=39%:%
%:%125=39%:%
%:%126=40%:%
%:%127=41%:%
%:%129=41%:%
%:%133=41%:%
%:%134=41%:%
%:%135=41%:%
%:%145=44%:%
%:%146=45%:%
%:%148=46%:%
%:%149=46%:%
%:%150=47%:%
%:%151=48%:%
%:%155=52%:%
%:%157=53%:%
%:%158=53%:%
%:%159=54%:%
%:%161=56%:%
%:%162=57%:%
%:%164=58%:%
%:%165=58%:%
%:%166=59%:%
%:%167=60%:%
%:%168=61%:%
%:%171=64%:%
%:%173=65%:%
%:%174=65%:%
%:%175=66%:%
%:%177=68%:%
%:%179=69%:%
%:%180=69%:%
%:%181=70%:%
%:%182=71%:%
%:%189=78%:%
%:%192=79%:%
%:%196=79%:%
%:%197=79%:%
%:%202=79%:%
%:%205=80%:%
%:%208=80%:%
%:%212=80%:%
%:%213=80%:%
%:%214=81%:%
%:%215=81%:%
%:%216=82%:%
%:%217=82%:%
%:%218=82%:%
%:%219=83%:%
%:%220=83%:%
%:%221=84%:%
%:%222=84%:%
%:%223=85%:%
%:%224=85%:%
%:%225=86%:%
%:%226=86%:%
%:%227=87%:%
%:%228=87%:%
%:%229=88%:%
%:%230=88%:%
%:%231=89%:%
%:%232=89%:%
%:%233=89%:%
%:%234=89%:%
%:%235=89%:%
%:%236=90%:%
%:%237=90%:%
%:%238=90%:%
%:%239=91%:%
%:%240=91%:%
%:%241=92%:%
%:%242=92%:%
%:%243=93%:%
%:%244=93%:%
%:%245=94%:%
%:%246=94%:%
%:%247=94%:%
%:%248=94%:%
%:%249=95%:%
%:%250=95%:%
%:%251=96%:%
%:%252=96%:%
%:%253=96%:%
%:%254=97%:%
%:%255=97%:%
%:%256=98%:%
%:%257=98%:%
%:%258=99%:%
%:%268=104%:%
%:%270=105%:%
%:%271=105%:%
%:%272=106%:%
%:%279=108%:%
%:%289=110%:%
%:%290=110%:%
%:%291=111%:%
%:%292=112%:%
%:%293=113%:%
%:%296=114%:%
%:%300=114%:%
%:%301=114%:%
%:%302=114%:%
%:%316=118%:%
%:%326=120%:%
%:%327=120%:%
%:%328=121%:%
%:%331=122%:%
%:%335=122%:%
%:%336=122%:%
%:%337=122%:%
%:%342=122%:%
%:%345=123%:%
%:%346=124%:%
%:%347=124%:%
%:%348=125%:%
%:%351=126%:%
%:%355=126%:%
%:%356=126%:%
%:%357=126%:%
%:%362=126%:%
%:%365=127%:%
%:%366=128%:%
%:%367=128%:%
%:%368=129%:%
%:%371=130%:%
%:%375=130%:%
%:%376=130%:%
%:%377=130%:%
%:%382=130%:%
%:%385=131%:%
%:%386=132%:%
%:%387=132%:%
%:%388=133%:%
%:%395=134%:%
%:%396=134%:%
%:%411=137%:%
%:%421=139%:%
%:%422=139%:%
%:%423=140%:%
%:%426=141%:%
%:%430=141%:%
%:%431=141%:%
%:%432=142%:%
%:%433=142%:%
%:%438=142%:%
%:%441=143%:%
%:%442=144%:%
%:%443=144%:%
%:%444=145%:%
%:%447=146%:%
%:%451=146%:%
%:%452=146%:%
%:%453=147%:%
%:%454=147%:%
%:%459=147%:%
%:%462=148%:%
%:%463=149%:%
%:%464=150%:%
%:%465=150%:%
%:%466=151%:%
%:%469=152%:%
%:%473=152%:%
%:%474=152%:%
%:%475=153%:%
%:%476=153%:%
%:%481=153%:%
%:%484=154%:%
%:%485=155%:%
%:%486=155%:%
%:%487=156%:%
%:%490=157%:%
%:%494=157%:%
%:%495=157%:%
%:%496=158%:%
%:%497=158%:%
%:%502=158%:%
%:%505=159%:%
%:%506=160%:%
%:%507=160%:%
%:%508=161%:%
%:%509=162%:%
%:%510=163%:%
%:%513=164%:%
%:%517=164%:%
%:%518=164%:%
%:%519=165%:%
%:%520=165%:%
%:%521=165%:%
%:%526=165%:%
%:%529=166%:%
%:%530=167%:%
%:%531=168%:%
%:%532=168%:%
%:%533=169%:%
%:%534=170%:%
%:%537=171%:%
%:%541=171%:%
%:%542=171%:%
%:%543=172%:%
%:%544=172%:%
%:%549=172%:%
%:%552=173%:%
%:%553=174%:%
%:%554=175%:%
%:%555=176%:%
%:%556=176%:%
%:%557=177%:%
%:%564=178%:%
%:%565=178%:%
%:%580=183%:%
%:%590=185%:%
%:%591=185%:%
%:%592=186%:%
%:%593=187%:%
%:%594=188%:%
%:%597=189%:%
%:%601=189%:%
%:%602=189%:%
%:%603=190%:%
%:%604=190%:%
%:%609=190%:%
%:%612=191%:%
%:%613=192%:%
%:%614=193%:%
%:%615=193%:%
%:%616=194%:%
%:%618=194%:%
%:%622=194%:%
%:%623=194%:%
%:%637=197%:%
%:%647=198%:%
%:%648=198%:%
%:%649=199%:%
%:%650=200%:%
%:%653=201%:%
%:%657=201%:%
%:%658=201%:%
%:%659=202%:%
%:%660=202%:%
%:%661=203%:%
%:%662=203%:%
%:%663=203%:%
%:%664=203%:%
%:%665=204%:%
%:%666=204%:%
%:%667=205%:%
%:%668=205%:%
%:%669=205%:%
%:%670=205%:%
%:%671=206%:%
%:%672=206%:%
%:%673=207%:%
%:%674=207%:%
%:%675=208%:%
%:%676=208%:%
%:%677=209%:%
%:%678=210%:%
%:%679=210%:%
%:%680=210%:%
%:%681=210%:%
%:%682=210%:%
%:%683=211%:%
%:%698=214%:%
%:%708=216%:%
%:%709=216%:%
%:%710=217%:%
%:%711=218%:%
%:%718=219%:%
%:%719=219%:%
%:%720=220%:%
%:%721=220%:%
%:%722=221%:%
%:%723=221%:%
%:%724=221%:%
%:%725=221%:%
%:%726=222%:%
%:%727=222%:%
%:%728=223%:%
%:%729=223%:%
%:%730=224%:%
%:%731=224%:%
%:%732=224%:%
%:%733=224%:%
%:%734=224%:%
%:%735=225%:%
%:%736=225%:%
%:%737=226%:%
%:%743=226%:%
%:%746=227%:%
%:%747=228%:%
%:%748=228%:%
%:%749=229%:%
%:%756=230%:%
%:%757=230%:%
%:%758=231%:%
%:%759=231%:%
%:%760=232%:%
%:%761=232%:%
%:%762=232%:%
%:%763=232%:%
%:%764=232%:%
%:%765=233%:%
%:%766=233%:%
%:%767=234%:%
%:%773=234%:%
%:%776=235%:%
%:%777=236%:%
%:%778=237%:%
%:%779=237%:%
%:%780=238%:%
%:%781=239%:%
%:%784=240%:%
%:%788=240%:%
%:%789=240%:%
%:%790=241%:%
%:%791=241%:%
%:%796=241%:%
%:%799=242%:%
%:%800=243%:%
%:%801=243%:%
%:%802=244%:%
%:%803=245%:%
%:%806=246%:%
%:%810=246%:%
%:%811=246%:%
%:%812=246%:%
%:%813=246%:%
%:%818=246%:%
%:%821=247%:%
%:%822=248%:%
%:%823=248%:%
%:%824=249%:%
%:%825=250%:%
%:%826=251%:%
%:%829=252%:%
%:%833=252%:%
%:%834=252%:%
%:%835=252%:%
%:%836=253%:%
%:%837=253%:%
%:%842=253%:%
%:%845=254%:%
%:%846=255%:%
%:%847=256%:%
%:%848=256%:%
%:%849=257%:%
%:%852=258%:%
%:%856=258%:%
%:%857=258%:%
%:%858=258%:%
%:%863=258%:%
%:%866=259%:%
%:%867=260%:%
%:%868=260%:%
%:%869=261%:%
%:%876=262%:%
%:%877=262%:%
%:%878=263%:%
%:%879=263%:%
%:%880=264%:%
%:%881=264%:%
%:%882=264%:%
%:%883=265%:%
%:%884=266%:%
%:%885=266%:%
%:%886=267%:%
%:%887=267%:%
%:%888=268%:%
%:%889=268%:%
%:%890=268%:%
%:%891=269%:%
%:%892=269%:%
%:%893=270%:%
%:%899=270%:%
%:%902=271%:%
%:%903=272%:%
%:%904=272%:%
%:%905=273%:%
%:%912=274%:%
%:%913=274%:%
%:%914=275%:%
%:%915=275%:%
%:%916=276%:%
%:%917=276%:%
%:%918=276%:%
%:%919=277%:%
%:%920=278%:%
%:%921=278%:%
%:%922=279%:%
%:%923=279%:%
%:%924=280%:%
%:%925=280%:%
%:%926=280%:%
%:%927=280%:%
%:%928=281%:%
%:%929=281%:%
%:%930=282%:%
%:%936=282%:%
%:%939=283%:%
%:%940=284%:%
%:%941=285%:%
%:%942=285%:%
%:%943=286%:%
%:%944=287%:%
%:%947=288%:%
%:%951=288%:%
%:%952=288%:%
%:%953=289%:%
%:%954=289%:%
%:%955=290%:%
%:%956=290%:%
%:%957=291%:%
%:%958=291%:%
%:%959=291%:%
%:%960=292%:%
%:%961=293%:%
%:%962=293%:%
%:%963=294%:%
%:%964=294%:%
%:%965=295%:%
%:%966=295%:%
%:%967=295%:%
%:%968=296%:%
%:%969=296%:%
%:%970=297%:%
%:%976=297%:%
%:%979=298%:%
%:%980=299%:%
%:%981=299%:%
%:%982=300%:%
%:%983=301%:%
%:%986=302%:%
%:%990=302%:%
%:%991=302%:%
%:%992=303%:%
%:%993=303%:%
%:%994=304%:%
%:%995=304%:%
%:%996=305%:%
%:%997=305%:%
%:%998=305%:%
%:%999=306%:%
%:%1000=306%:%
%:%1001=307%:%
%:%1002=307%:%
%:%1003=308%:%
%:%1004=308%:%
%:%1005=309%:%
%:%1011=309%:%
%:%1014=310%:%
%:%1015=311%:%
%:%1016=311%:%
%:%1017=312%:%
%:%1018=313%:%
%:%1021=314%:%
%:%1025=314%:%
%:%1026=314%:%
%:%1027=315%:%
%:%1028=315%:%
%:%1033=315%:%
%:%1036=316%:%
%:%1037=317%:%
%:%1038=317%:%
%:%1039=318%:%
%:%1040=319%:%
%:%1041=320%:%
%:%1044=321%:%
%:%1048=321%:%
%:%1049=321%:%
%:%1050=322%:%
%:%1051=322%:%
%:%1052=323%:%
%:%1053=323%:%
%:%1054=324%:%
%:%1055=324%:%
%:%1056=324%:%
%:%1057=325%:%
%:%1058=325%:%
%:%1059=326%:%
%:%1060=326%:%
%:%1061=327%:%
%:%1062=327%:%
%:%1063=328%:%
%:%1069=328%:%
%:%1072=329%:%
%:%1073=330%:%
%:%1074=330%:%
%:%1075=331%:%
%:%1076=332%:%
%:%1077=333%:%
%:%1078=334%:%
%:%1085=335%:%
%:%1086=335%:%
%:%1087=336%:%
%:%1088=336%:%
%:%1089=336%:%
%:%1090=336%:%
%:%1091=337%:%
%:%1092=337%:%
%:%1093=338%:%
%:%1094=338%:%
%:%1095=338%:%
%:%1096=339%:%
%:%1097=339%:%
%:%1098=339%:%
%:%1099=340%:%
%:%1100=341%:%
%:%1101=342%:%
%:%1102=342%:%
%:%1103=343%:%
%:%1104=343%:%
%:%1105=343%:%
%:%1106=344%:%
%:%1107=344%:%
%:%1108=345%:%
%:%1109=345%:%
%:%1110=346%:%
%:%1111=346%:%
%:%1112=347%:%
%:%1113=347%:%
%:%1114=348%:%
%:%1115=348%:%
%:%1116=349%:%
%:%1117=349%:%
%:%1118=350%:%
%:%1119=350%:%
%:%1120=351%:%
%:%1121=351%:%
%:%1122=351%:%
%:%1123=351%:%
%:%1124=352%:%
%:%1125=352%:%
%:%1126=353%:%
%:%1127=353%:%
%:%1128=354%:%
%:%1129=354%:%
%:%1130=354%:%
%:%1131=354%:%
%:%1132=355%:%
%:%1133=355%:%
%:%1134=356%:%
%:%1135=356%:%
%:%1136=357%:%
%:%1137=357%:%
%:%1138=358%:%
%:%1139=358%:%
%:%1140=358%:%
%:%1141=359%:%
%:%1142=359%:%
%:%1143=359%:%
%:%1144=359%:%
%:%1145=359%:%
%:%1146=360%:%
%:%1147=360%:%
%:%1148=360%:%
%:%1149=361%:%
%:%1150=361%:%
%:%1151=361%:%
%:%1152=362%:%
%:%1158=362%:%
%:%1161=363%:%
%:%1162=364%:%
%:%1163=365%:%
%:%1164=365%:%
%:%1165=366%:%
%:%1166=367%:%
%:%1169=368%:%
%:%1173=368%:%
%:%1174=368%:%
%:%1175=369%:%
%:%1176=369%:%
%:%1182=369%:%
%:%1185=370%:%
%:%1186=371%:%
%:%1187=371%:%
%:%1188=372%:%
%:%1189=373%:%
%:%1190=374%:%
%:%1191=375%:%
%:%1192=376%:%
%:%1193=377%:%
%:%1194=378%:%
%:%1195=379%:%
%:%1196=380%:%
%:%1197=381%:%
%:%1204=382%:%
%:%1205=382%:%
%:%1206=383%:%
%:%1207=383%:%
%:%1208=383%:%
%:%1209=383%:%
%:%1210=384%:%
%:%1211=384%:%
%:%1212=385%:%
%:%1213=385%:%
%:%1214=385%:%
%:%1215=386%:%
%:%1216=386%:%
%:%1217=386%:%
%:%1218=387%:%
%:%1219=388%:%
%:%1220=389%:%
%:%1221=389%:%
%:%1222=390%:%
%:%1223=390%:%
%:%1224=390%:%
%:%1225=391%:%
%:%1226=391%:%
%:%1227=392%:%
%:%1228=392%:%
%:%1229=393%:%
%:%1230=393%:%
%:%1231=393%:%
%:%1232=394%:%
%:%1233=394%:%
%:%1234=394%:%
%:%1235=395%:%
%:%1236=395%:%
%:%1237=395%:%
%:%1238=396%:%
%:%1239=396%:%
%:%1240=396%:%
%:%1241=397%:%
%:%1242=397%:%
%:%1243=397%:%
%:%1244=398%:%
%:%1245=398%:%
%:%1246=399%:%
%:%1247=399%:%
%:%1248=400%:%
%:%1249=400%:%
%:%1250=401%:%
%:%1251=401%:%
%:%1252=401%:%
%:%1253=401%:%
%:%1254=402%:%
%:%1255=402%:%
%:%1256=403%:%
%:%1257=403%:%
%:%1258=404%:%
%:%1259=404%:%
%:%1260=405%:%
%:%1261=405%:%
%:%1262=406%:%
%:%1263=406%:%
%:%1264=406%:%
%:%1265=407%:%
%:%1266=407%:%
%:%1267=408%:%
%:%1268=408%:%
%:%1269=409%:%
%:%1284=411%:%
%:%1294=413%:%
%:%1295=413%:%
%:%1296=414%:%
%:%1297=415%:%
%:%1298=416%:%
%:%1301=417%:%
%:%1305=417%:%
%:%1306=417%:%
%:%1307=418%:%
%:%1308=418%:%
%:%1309=419%:%
%:%1310=419%:%
%:%1311=420%:%
%:%1312=420%:%
%:%1313=420%:%
%:%1314=420%:%
%:%1315=421%:%
%:%1316=421%:%
%:%1317=422%:%
%:%1318=422%:%
%:%1319=422%:%
%:%1320=422%:%
%:%1321=423%:%
%:%1322=423%:%
%:%1323=423%:%
%:%1324=424%:%
%:%1325=424%:%
%:%1326=425%:%
%:%1327=425%:%
%:%1328=426%:%
%:%1329=426%:%
%:%1330=426%:%
%:%1331=427%:%
%:%1332=427%:%
%:%1333=427%:%
%:%1334=428%:%
%:%1335=428%:%
%:%1336=428%:%
%:%1337=428%:%
%:%1338=429%:%
%:%1339=430%:%
%:%1340=430%:%
%:%1341=431%:%
%:%1342=431%:%
%:%1343=432%:%
%:%1344=432%:%
%:%1345=433%:%
%:%1346=433%:%
%:%1347=434%:%
%:%1348=434%:%
%:%1349=434%:%
%:%1350=435%:%
%:%1351=435%:%
%:%1352=436%:%
%:%1353=436%:%
%:%1354=437%:%
%:%1355=437%:%
%:%1356=437%:%
%:%1357=438%:%
%:%1358=438%:%
%:%1359=438%:%
%:%1360=439%:%
%:%1361=439%:%
%:%1362=440%:%
%:%1363=440%:%
%:%1364=441%:%
%:%1365=441%:%
%:%1366=442%:%
%:%1367=442%:%
%:%1368=443%:%
%:%1369=443%:%
%:%1370=443%:%
%:%1371=443%:%
%:%1372=444%:%
%:%1373=444%:%
%:%1374=444%:%
%:%1375=444%:%
%:%1376=445%:%
%:%1377=445%:%
%:%1378=445%:%
%:%1379=445%:%
%:%1380=446%:%
%:%1381=446%:%
%:%1382=447%:%
%:%1383=447%:%
%:%1384=448%:%
%:%1385=448%:%
%:%1386=449%:%
%:%1387=449%:%
%:%1388=450%:%
%:%1389=450%:%
%:%1390=451%:%
%:%1391=451%:%
%:%1392=451%:%
%:%1393=452%:%
%:%1394=453%:%
%:%1395=453%:%
%:%1396=454%:%
%:%1397=454%:%
%:%1398=454%:%
%:%1399=455%:%
%:%1400=456%:%
%:%1401=456%:%
%:%1402=457%:%
%:%1403=457%:%
%:%1404=458%:%
%:%1405=458%:%
%:%1406=458%:%
%:%1407=458%:%
%:%1408=458%:%
%:%1409=459%:%
%:%1410=459%:%
%:%1411=460%:%
%:%1412=460%:%
%:%1413=461%:%
%:%1414=461%:%
%:%1415=462%:%
%:%1416=462%:%
%:%1417=462%:%
%:%1418=463%:%
%:%1419=463%:%
%:%1421=465%:%
%:%1422=466%:%
%:%1423=466%:%
%:%1424=467%:%
%:%1425=467%:%
%:%1426=468%:%
%:%1427=468%:%
%:%1428=468%:%
%:%1429=468%:%
%:%1430=469%:%
%:%1431=469%:%
%:%1432=470%:%
%:%1433=470%:%
%:%1434=471%:%
%:%1435=471%:%
%:%1436=472%:%
%:%1437=472%:%
%:%1438=472%:%
%:%1439=473%:%
%:%1440=473%:%
%:%1441=473%:%
%:%1442=474%:%
%:%1443=474%:%
%:%1444=474%:%
%:%1445=475%:%
%:%1446=475%:%
%:%1447=475%:%
%:%1448=476%:%
%:%1449=476%:%
%:%1450=476%:%
%:%1451=477%:%
%:%1452=478%:%
%:%1453=478%:%
%:%1454=479%:%
%:%1455=479%:%
%:%1456=480%:%
%:%1457=480%:%
%:%1458=480%:%
%:%1459=481%:%
%:%1460=482%:%
%:%1461=482%:%
%:%1462=483%:%
%:%1463=483%:%
%:%1464=483%:%
%:%1465=484%:%
%:%1466=485%:%
%:%1467=485%:%
%:%1468=485%:%
%:%1469=486%:%
%:%1470=486%:%
%:%1471=486%:%
%:%1472=487%:%
%:%1473=487%:%
%:%1474=488%:%
%:%1475=488%:%
%:%1476=488%:%
%:%1477=489%:%
%:%1478=489%:%
%:%1479=489%:%
%:%1481=491%:%
%:%1482=492%:%
%:%1483=492%:%
%:%1484=493%:%
%:%1485=493%:%
%:%1486=493%:%
%:%1488=495%:%
%:%1489=495%:%
%:%1490=496%:%
%:%1491=496%:%
%:%1492=497%:%
%:%1493=497%:%
%:%1494=497%:%
%:%1495=498%:%
%:%1496=498%:%
%:%1497=499%:%
%:%1498=500%:%
%:%1499=500%:%
%:%1500=501%:%
%:%1501=501%:%
%:%1502=502%:%
%:%1503=502%:%
%:%1504=503%:%
%:%1510=503%:%
%:%1513=504%:%
%:%1514=505%:%
%:%1515=506%:%
%:%1516=506%:%
%:%1517=507%:%
%:%1518=508%:%
%:%1521=509%:%
%:%1525=509%:%
%:%1526=509%:%
%:%1527=510%:%
%:%1528=510%:%
%:%1529=511%:%
%:%1530=511%:%
%:%1531=512%:%
%:%1532=512%:%
%:%1533=513%:%
%:%1534=514%:%
%:%1535=514%:%
%:%1536=515%:%
%:%1537=515%:%
%:%1538=515%:%
%:%1539=516%:%
%:%1540=516%:%
%:%1541=517%:%
%:%1542=517%:%
%:%1543=518%:%
%:%1544=518%:%
%:%1545=518%:%
%:%1546=518%:%
%:%1547=518%:%
%:%1548=519%:%
%:%1549=519%:%
%:%1550=520%:%
%:%1551=520%:%
%:%1552=521%:%
%:%1553=521%:%
%:%1554=521%:%
%:%1555=521%:%
%:%1556=522%:%
%:%1557=522%:%
%:%1558=522%:%
%:%1559=523%:%
%:%1560=523%:%
%:%1561=524%:%
%:%1562=524%:%
%:%1563=525%:%
%:%1564=525%:%
%:%1565=525%:%
%:%1566=526%:%
%:%1567=526%:%
%:%1568=527%:%
%:%1569=527%:%
%:%1570=527%:%
%:%1571=527%:%
%:%1572=528%:%
%:%1573=528%:%
%:%1574=529%:%
%:%1575=529%:%
%:%1576=530%:%
%:%1577=530%:%
%:%1578=531%:%
%:%1579=531%:%
%:%1580=531%:%
%:%1581=532%:%
%:%1582=532%:%
%:%1584=534%:%
%:%1585=534%:%
%:%1586=534%:%
%:%1587=535%:%
%:%1588=535%:%
%:%1589=536%:%
%:%1590=536%:%
%:%1591=536%:%
%:%1592=537%:%
%:%1593=538%:%
%:%1594=538%:%
%:%1595=539%:%
%:%1596=539%:%
%:%1597=540%:%
%:%1598=540%:%
%:%1599=540%:%
%:%1600=541%:%
%:%1601=542%:%
%:%1602=542%:%
%:%1603=542%:%
%:%1604=543%:%
%:%1605=543%:%
%:%1606=543%:%
%:%1607=543%:%
%:%1608=544%:%
%:%1609=544%:%
%:%1610=545%:%
%:%1611=545%:%
%:%1612=545%:%
%:%1613=545%:%
%:%1614=546%:%
%:%1615=547%:%
%:%1616=547%:%
%:%1617=548%:%
%:%1618=548%:%
%:%1619=549%:%
%:%1620=549%:%
%:%1621=550%:%
%:%1622=550%:%
%:%1623=550%:%
%:%1624=551%:%
%:%1625=551%:%
%:%1626=552%:%
%:%1627=552%:%
%:%1628=553%:%
%:%1629=554%:%
%:%1630=554%:%
%:%1631=554%:%
%:%1632=554%:%
%:%1633=555%:%
%:%1634=555%:%
%:%1635=556%:%
%:%1636=556%:%
%:%1637=556%:%
%:%1638=556%:%
%:%1639=556%:%
%:%1640=557%:%
%:%1641=558%:%
%:%1642=558%:%
%:%1643=559%:%
%:%1644=559%:%
%:%1645=560%:%
%:%1646=560%:%
%:%1647=560%:%
%:%1648=560%:%
%:%1649=561%:%
%:%1650=561%:%
%:%1651=562%:%
%:%1652=562%:%
%:%1653=563%:%
%:%1654=563%:%
%:%1655=563%:%
%:%1656=564%:%
%:%1657=564%:%
%:%1658=565%:%
%:%1659=565%:%
%:%1660=566%:%
%:%1661=566%:%
%:%1662=566%:%
%:%1663=566%:%
%:%1664=567%:%
%:%1665=568%:%
%:%1666=568%:%
%:%1667=569%:%
%:%1668=569%:%
%:%1669=569%:%
%:%1670=569%:%
%:%1671=570%:%
%:%1672=570%:%
%:%1673=571%:%
%:%1674=571%:%
%:%1675=572%:%
%:%1676=572%:%
%:%1677=573%:%
%:%1678=573%:%
%:%1679=574%:%
%:%1680=574%:%
%:%1681=575%:%
%:%1687=575%:%
%:%1690=576%:%
%:%1691=577%:%
%:%1692=578%:%
%:%1693=578%:%
%:%1694=579%:%
%:%1701=580%:%
%:%1702=580%:%
%:%1703=581%:%
%:%1704=581%:%
%:%1705=582%:%
%:%1706=582%:%
%:%1707=582%:%
%:%1708=582%:%
%:%1709=583%:%
%:%1710=583%:%
%:%1711=584%:%
%:%1712=584%:%
%:%1713=584%:%
%:%1714=584%:%
%:%1715=584%:%
%:%1716=585%:%
%:%1717=585%:%
%:%1718=586%:%
%:%1719=586%:%
%:%1720=587%:%
%:%1721=587%:%
%:%1722=587%:%
%:%1723=587%:%
%:%1724=587%:%
%:%1725=588%:%
%:%1726=588%:%
%:%1727=589%:%
%:%1728=589%:%
%:%1729=590%:%
%:%1730=590%:%
%:%1731=590%:%
%:%1732=591%:%
%:%1733=591%:%
%:%1734=592%:%
%:%1735=592%:%
%:%1736=592%:%
%:%1737=592%:%
%:%1738=593%:%
%:%1739=593%:%
%:%1740=594%:%
%:%1741=595%:%
%:%1742=595%:%
%:%1743=596%:%
%:%1744=596%:%
%:%1745=596%:%
%:%1747=598%:%
%:%1748=598%:%
%:%1749=599%:%
%:%1750=599%:%
%:%1751=600%:%
%:%1752=600%:%
%:%1753=600%:%
%:%1754=601%:%
%:%1755=601%:%
%:%1756=602%:%
%:%1757=602%:%
%:%1758=602%:%
%:%1759=603%:%
%:%1760=603%:%
%:%1761=604%:%
%:%1762=604%:%
%:%1763=604%:%
%:%1764=604%:%
%:%1765=605%:%
%:%1766=606%:%
%:%1767=606%:%
%:%1768=607%:%
%:%1769=607%:%
%:%1770=607%:%
%:%1771=608%:%
%:%1772=609%:%
%:%1773=609%:%
%:%1774=609%:%
%:%1775=610%:%
%:%1776=610%:%
%:%1777=610%:%
%:%1778=611%:%
%:%1779=612%:%
%:%1780=612%:%
%:%1781=613%:%
%:%1782=613%:%
%:%1783=614%:%
%:%1784=614%:%
%:%1785=614%:%
%:%1786=615%:%
%:%1787=615%:%
%:%1788=616%:%
%:%1789=616%:%
%:%1790=616%:%
%:%1791=616%:%
%:%1792=617%:%
%:%1793=617%:%
%:%1794=618%:%
%:%1795=619%:%
%:%1796=619%:%
%:%1797=620%:%
%:%1798=620%:%
%:%1799=621%:%
%:%1800=621%:%
%:%1801=622%:%
%:%1807=622%:%
%:%1810=623%:%
%:%1811=624%:%
%:%1812=624%:%
%:%1813=625%:%
%:%1814=626%:%
%:%1817=627%:%
%:%1821=627%:%
%:%1822=627%:%
%:%1823=628%:%
%:%1824=628%:%
%:%1829=628%:%
%:%1832=629%:%
%:%1833=630%:%
%:%1834=630%:%
%:%1835=631%:%
%:%1836=632%:%
%:%1839=633%:%
%:%1843=633%:%
%:%1844=633%:%
%:%1845=634%:%
%:%1846=635%:%
%:%1847=635%:%
%:%1852=635%:%
%:%1855=636%:%
%:%1856=637%:%
%:%1857=637%:%
%:%1858=638%:%
%:%1859=639%:%
%:%1862=640%:%
%:%1866=640%:%
%:%1867=640%:%
%:%1868=640%:%
%:%1869=641%:%
%:%1870=641%:%
%:%1871=642%:%
%:%1872=642%:%
%:%1873=642%:%
%:%1874=642%:%
%:%1875=643%:%
%:%1876=643%:%
%:%1877=644%:%
%:%1878=644%:%
%:%1879=644%:%
%:%1880=644%:%
%:%1881=644%:%
%:%1882=645%:%
%:%1883=645%:%
%:%1884=646%:%
%:%1885=646%:%
%:%1886=647%:%
%:%1887=647%:%
%:%1888=647%:%
%:%1889=647%:%
%:%1890=647%:%
%:%1891=648%:%
%:%1892=648%:%
%:%1893=649%:%
%:%1894=649%:%
%:%1895=650%:%
%:%1896=650%:%
%:%1897=651%:%
%:%1898=651%:%
%:%1899=651%:%
%:%1900=652%:%
%:%1901=652%:%
%:%1902=653%:%
%:%1903=653%:%
%:%1904=653%:%
%:%1905=654%:%
%:%1906=654%:%
%:%1907=655%:%
%:%1908=655%:%
%:%1909=655%:%
%:%1910=655%:%
%:%1911=656%:%
%:%1912=656%:%
%:%1913=657%:%
%:%1914=657%:%
%:%1915=658%:%
%:%1916=658%:%
%:%1917=658%:%
%:%1918=658%:%
%:%1919=659%:%
%:%1920=659%:%
%:%1921=660%:%
%:%1922=661%:%
%:%1923=661%:%
%:%1924=662%:%
%:%1925=662%:%
%:%1926=662%:%
%:%1928=664%:%
%:%1929=664%:%
%:%1930=665%:%
%:%1931=665%:%
%:%1932=666%:%
%:%1933=666%:%
%:%1934=667%:%
%:%1935=667%:%
%:%1936=667%:%
%:%1937=668%:%
%:%1938=668%:%
%:%1939=669%:%
%:%1940=669%:%
%:%1941=669%:%
%:%1942=669%:%
%:%1943=670%:%
%:%1944=671%:%
%:%1945=671%:%
%:%1946=672%:%
%:%1947=672%:%
%:%1948=672%:%
%:%1949=673%:%
%:%1950=673%:%
%:%1951=673%:%
%:%1952=674%:%
%:%1953=674%:%
%:%1954=675%:%
%:%1955=675%:%
%:%1956=675%:%
%:%1957=676%:%
%:%1958=676%:%
%:%1959=676%:%
%:%1960=677%:%
%:%1961=677%:%
%:%1962=678%:%
%:%1963=678%:%
%:%1964=678%:%
%:%1965=679%:%
%:%1966=679%:%
%:%1967=680%:%
%:%1968=680%:%
%:%1969=680%:%
%:%1970=681%:%
%:%1971=681%:%
%:%1972=682%:%
%:%1973=682%:%
%:%1974=682%:%
%:%1975=683%:%
%:%1976=683%:%
%:%1977=683%:%
%:%1978=684%:%
%:%1979=684%:%
%:%1980=685%:%
%:%1986=685%:%
%:%1989=686%:%
%:%1990=687%:%
%:%1993=688%:%
%:%1998=689%:%