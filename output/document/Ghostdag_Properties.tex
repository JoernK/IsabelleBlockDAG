%
\begin{isabellebody}%
\setisabellecontext{Ghostdag{\isacharunderscore}{\kern0pt}Properties}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Ghostdag{\isacharunderscore}{\kern0pt}Properties\isanewline
\ \ \isakeyword{imports}\ Properties\ Ghostdag\ \ \isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{GHOSTDAG properties%
}
\isamarkuptrue%
%
\isamarkupsubsection{GHOSTDAG Order Preserving%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ GhostDAG{\isacharunderscore}{\kern0pt}preserving{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ {\isachardoublequoteopen}x\ {\isasymrightarrow}\isactrlsup {\isacharplus}{\kern0pt}\isactrlbsub G\isactrlesub \ y{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isasymin}\ GHOSTDAG\ k\ G{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ GHOSTDAG{\isachardot}{\kern0pt}simps\ \isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}induct\ G\ k\ arbitrary{\isacharcolon}{\kern0pt}\ x\ y\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isachardot}{\kern0pt}induct\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ G\ rule{\isacharcolon}{\kern0pt}\ OrderDAG{\isacharunderscore}{\kern0pt}casesAlt{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ ntB\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ one\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ x\ {\isasymrightarrow}\isactrlsup {\isacharplus}{\kern0pt}\isactrlbsub G\isactrlesub \ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ wf{\isacharunderscore}{\kern0pt}digraph{\isachardot}{\kern0pt}reachable{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts\ {\isadigit{1}}\ DAG{\isachardot}{\kern0pt}cycle{\isacharunderscore}{\kern0pt}free\ OrderDAG{\isacharunderscore}{\kern0pt}casesAlt\isanewline
\ \ \ \ \ \ \ \ blockDAG{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}less\ blockDAG{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past{\isacharunderscore}{\kern0pt}dagbased\ blockDAG{\isachardot}{\kern0pt}unique{\isacharunderscore}{\kern0pt}genesis\ less{\isacharunderscore}{\kern0pt}one\isanewline
\ \ \ \ \ \ \ \ not{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}zero\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\ \ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\ \ \isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ more\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ pp\ \isakeyword{where}\ pp{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pp\ {\isacharequal}{\kern0pt}\ \ {\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ i{\isacharparenright}{\kern0pt}\ k{\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}exist\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ backw{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ less{\isacharunderscore}{\kern0pt}irrefl{\isacharunderscore}{\kern0pt}nat\ more\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ S\ \isakeyword{where}\ s{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ S{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ t\ \isakeyword{where}\ t{\isacharunderscore}{\kern0pt}in\ {\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ t{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ ma\ \isakeyword{where}\ ma{\isacharunderscore}{\kern0pt}def{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ma\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}vert{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}ma\ {\isasymin}\ verts\ G{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ digraph{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts\isanewline
\ \ \ \ \ \ \ \ more{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ subs\ subsetD\ pp{\isacharunderscore}{\kern0pt}in\ \isacommand{by}\isamarkupfalse%
\ blast\ \isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}tip{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}tip\ G\ ma{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ more\ pp{\isacharunderscore}{\kern0pt}in\ \ tips{\isacharunderscore}{\kern0pt}tips\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \ \ \ \ \ \ \ \ \ \isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ no{\isacharunderscore}{\kern0pt}gen{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ blockDAG{\isachardot}{\kern0pt}is{\isacharunderscore}{\kern0pt}genesis{\isacharunderscore}{\kern0pt}node\ G\ ma{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\ \ \isacommand{using}\isamarkupfalse%
\ pp{\isacharunderscore}{\kern0pt}in\ \isanewline
\ \ \ \ \ \ \ \ blockDAG{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}unequal{\isacharunderscore}{\kern0pt}gen\ more\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ red{\isacharunderscore}{\kern0pt}bd{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ ma{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ blockDAG{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past{\isacharunderscore}{\kern0pt}dagbased\ more\ ma{\isacharunderscore}{\kern0pt}vert\ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}ind{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma\ {\isasymand}\ y\ {\isasymin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}{\isacharparenleft}{\kern0pt}x{\isacharunderscore}{\kern0pt}in{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymnotin}\ \ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma\ {\isasymand}\ y\ {\isasymin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}{\isacharparenleft}{\kern0pt}y{\isacharunderscore}{\kern0pt}in{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ \ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma\ {\isasymand}\ y\ {\isasymnotin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ {\isacharbar}{\kern0pt}{\isacharparenleft}{\kern0pt}both{\isacharunderscore}{\kern0pt}nin{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymnotin}\ \ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma\ {\isasymand}\ y\ {\isasymnotin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ ind\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymrightarrow}\isactrlsup {\isacharplus}{\kern0pt}\isactrlbsub reduce{\isacharunderscore}{\kern0pt}past\ G\ ma\isactrlesub \ y{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ DAG{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past{\isacharunderscore}{\kern0pt}path{\isadigit{2}}\ more\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ {\isadigit{1}}\ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}tips{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ ma\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}in\ more{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ ma{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ more\ {\isadigit{1}}\ ind\ less{\isacharunderscore}{\kern0pt}numeral{\isacharunderscore}{\kern0pt}extra{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ ma{\isacharunderscore}{\kern0pt}def\ red{\isacharunderscore}{\kern0pt}bd\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ pp{\isacharunderscore}{\kern0pt}in\ {\isadigit{1}}\ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ rel{\isacharunderscore}{\kern0pt}base{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}mono\ prod{\isachardot}{\kern0pt}collapse\ snd{\isacharunderscore}{\kern0pt}conv\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\ \isanewline
\isanewline
\ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ \ ma{\isacharunderscore}{\kern0pt}def\ backw\ s{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ rel{\isacharunderscore}{\kern0pt}base\ \ \isacommand{unfolding}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}in\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}rel\ prod{\isachardot}{\kern0pt}collapse\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\ \ \ \ \ \ \ \isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G\ ma{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ reduce{\isacharunderscore}{\kern0pt}past{\isachardot}{\kern0pt}simps\ \isacommand{using}\isamarkupfalse%
\ induce{\isacharunderscore}{\kern0pt}subgraph{\isacharunderscore}{\kern0pt}verts\ Verts{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}OrderDAG\ \isanewline
\ \ \ \ \ \ \ \ \ \ more\ red{\isacharunderscore}{\kern0pt}bd\ reduce{\isacharunderscore}{\kern0pt}past{\isachardot}{\kern0pt}elims\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}base{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ ma{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ chosen{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{6}}{\isacharparenright}{\kern0pt}\ more\ pp{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\ \isanewline
\ \ \ \ \ \ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}x{\isacharunderscore}{\kern0pt}t{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ ma{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharunderscore}{\kern0pt}ant{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ anticone\ G\ ma{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ DAG{\isachardot}{\kern0pt}verts{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\ \ ma{\isacharunderscore}{\kern0pt}tip\ ma{\isacharunderscore}{\kern0pt}vert\ \isanewline
\ \ \ \ \ \ \ \ \ \ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq\ tips{\isacharunderscore}{\kern0pt}def\ wf{\isacharunderscore}{\kern0pt}digraph{\isachardot}{\kern0pt}reachable{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}t\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isasymin}\ \ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}t\ ma{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}base\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}append\ prod{\isachardot}{\kern0pt}collapse\ sndI\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ \ ma{\isacharunderscore}{\kern0pt}def\ backw\ s{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ t{\isacharunderscore}{\kern0pt}in\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}rel\ prod{\isachardot}{\kern0pt}collapse\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\ \ \ \ \ \isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}ant\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ more\ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ DAG{\isachardot}{\kern0pt}anticon{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharparenleft}{\kern0pt}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ pp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ \ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isacharunderscore}{\kern0pt}mono\ in{\isacharunderscore}{\kern0pt}mono\ prod{\isachardot}{\kern0pt}collapse\ y{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}base\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ backw\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}rel\ ma{\isacharunderscore}{\kern0pt}def\ prod{\isachardot}{\kern0pt}collapse\ top{\isacharunderscore}{\kern0pt}sort{\isacharunderscore}{\kern0pt}con{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}in\isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma{\isachardoublequoteclose}\ \isacommand{unfolding}\isamarkupfalse%
\ past{\isacharunderscore}{\kern0pt}nodes{\isachardot}{\kern0pt}simps\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ wf{\isacharunderscore}{\kern0pt}digraph{\isachardot}{\kern0pt}reachable{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ subs{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq\ trancl{\isacharunderscore}{\kern0pt}trans\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}in\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ both{\isacharunderscore}{\kern0pt}nin\isanewline
\ \ \ \ \ \ \isacommand{consider}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}x{\isacharunderscore}{\kern0pt}t{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ ma{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharunderscore}{\kern0pt}ant{\isacharparenright}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymin}\ anticone\ G\ ma{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ DAG{\isachardot}{\kern0pt}verts{\isacharunderscore}{\kern0pt}comp{\isadigit{2}}\ \isanewline
\ \ \ \ \ \ \ \ \ \ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}\ \ ma{\isacharunderscore}{\kern0pt}tip\ ma{\isacharunderscore}{\kern0pt}vert\ \isanewline
\ \ \ \ \ \ \ \ \ \ mem{\isacharunderscore}{\kern0pt}Collect{\isacharunderscore}{\kern0pt}eq\ tips{\isacharunderscore}{\kern0pt}def\ wf{\isacharunderscore}{\kern0pt}digraph{\isachardot}{\kern0pt}reachable{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ both{\isacharunderscore}{\kern0pt}nin\isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}t\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ past{\isacharunderscore}{\kern0pt}nodes\ G\ ma{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ more\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ past{\isacharunderscore}{\kern0pt}nodes{\isachardot}{\kern0pt}simps\ \isacommand{unfolding}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}t\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ subs\ wf{\isacharunderscore}{\kern0pt}digraph{\isachardot}{\kern0pt}reachable{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ both{\isacharunderscore}{\kern0pt}nin\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \ \ \ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}ina{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ anticone\ G\ ma{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}rule\ ccontr{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ y\ {\isasymin}\ anticone\ G\ ma\ {\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isacharequal}{\kern0pt}\ ma{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ anticone{\isachardot}{\kern0pt}simps\ \isacommand{using}\isamarkupfalse%
\ subs\ wf{\isacharunderscore}{\kern0pt}digraph{\isachardot}{\kern0pt}reachable{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}verts{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ ma{\isacharunderscore}{\kern0pt}tip\ both{\isacharunderscore}{\kern0pt}nin\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\ \ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymrightarrow}\isactrlsup {\isacharplus}{\kern0pt}\isactrlbsub G\isactrlesub \ ma{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ False\ \isacommand{using}\isamarkupfalse%
\ subs{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ \ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ wf{\isacharunderscore}{\kern0pt}digraph{\isachardot}{\kern0pt}tips{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}referenced\ ma{\isacharunderscore}{\kern0pt}tip{\isacharparenright}{\kern0pt}\ \ \isanewline
\ \ \ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \isacommand{case}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}ant\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}y{\isacharcomma}{\kern0pt}x{\isacharparenright}{\kern0pt}\ {\isasymin}\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel\ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G\ ma{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}ina\ DAG{\isachardot}{\kern0pt}anticon{\isacharunderscore}{\kern0pt}finite\ subs{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isadigit{1}}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharcomma}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ top{\isacharunderscore}{\kern0pt}sort{\isacharunderscore}{\kern0pt}rel\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \ \ \ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{unfolding}\isamarkupfalse%
\ backw\ ma{\isacharunderscore}{\kern0pt}def\ \ \isacommand{using}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ fold{\isacharunderscore}{\kern0pt}app{\isacharunderscore}{\kern0pt}mono\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ old{\isachardot}{\kern0pt}prod{\isachardot}{\kern0pt}exhaust{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}k{\isachardot}{\kern0pt}\ Order{\isacharunderscore}{\kern0pt}Preserving\ {\isacharparenleft}{\kern0pt}GHOSTDAG\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Order{\isacharunderscore}{\kern0pt}Preserving{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ GhostDAG{\isacharunderscore}{\kern0pt}preserving\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{GHOSTDAG Linear Order%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ GhostDAG{\isacharunderscore}{\kern0pt}linear{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}blockDAG\ G{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}linear{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}GHOSTDAG\ k\ G{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ GHOSTDAG{\isachardot}{\kern0pt}simps\ \isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}linear\ OrderDAG{\isacharunderscore}{\kern0pt}distinct\ OrderDAG{\isacharunderscore}{\kern0pt}total\ assms\ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}k{\isachardot}{\kern0pt}\ Linear{\isacharunderscore}{\kern0pt}Order\ {\isacharparenleft}{\kern0pt}GHOSTDAG\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Linear{\isacharunderscore}{\kern0pt}Order{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ GhostDAG{\isacharunderscore}{\kern0pt}linear\ \isacommand{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{GHOSTDAG One Appending Monotone%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ OrderDAG{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}one{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}Honest{\isacharunderscore}{\kern0pt}Append{\isacharunderscore}{\kern0pt}One\ G\ G{\isacharunderscore}{\kern0pt}A\ a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G{\isacharunderscore}{\kern0pt}A\ k{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ bD{\isacharunderscore}{\kern0pt}A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}blockDAG\ G{\isacharunderscore}{\kern0pt}A{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ assms\ Append{\isacharunderscore}{\kern0pt}One{\isachardot}{\kern0pt}bD{\isacharunderscore}{\kern0pt}A\ Honest{\isacharunderscore}{\kern0pt}Append{\isacharunderscore}{\kern0pt}One{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ g{\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}card\ {\isacharparenleft}{\kern0pt}verts\ G{\isacharunderscore}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isasymnoteq}\ {\isadigit{1}}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ Append{\isacharunderscore}{\kern0pt}One{\isachardot}{\kern0pt}append{\isacharunderscore}{\kern0pt}greater{\isacharunderscore}{\kern0pt}{\isadigit{1}}\ Honest{\isacharunderscore}{\kern0pt}Append{\isacharunderscore}{\kern0pt}One{\isacharunderscore}{\kern0pt}def\ less{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}refl\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}tips\ G{\isacharunderscore}{\kern0pt}A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ Honest{\isacharunderscore}{\kern0pt}Append{\isacharunderscore}{\kern0pt}One{\isachardot}{\kern0pt}append{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}only{\isacharunderscore}{\kern0pt}tip\ assms\ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ tips{\isacharunderscore}{\kern0pt}app{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharunderscore}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{by}\isamarkupfalse%
\ auto\ \isanewline
\ \ \isacommand{obtain}\isamarkupfalse%
\ the{\isacharunderscore}{\kern0pt}map\ \isakeyword{where}\ the{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}in{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}the{\isacharunderscore}{\kern0pt}map\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}map\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G{\isacharunderscore}{\kern0pt}A\ i{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcomma}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}tips\ G{\isacharunderscore}{\kern0pt}A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ m{\isacharunderscore}{\kern0pt}l{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}\ the{\isacharunderscore}{\kern0pt}map\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G{\isacharunderscore}{\kern0pt}A\ a{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ the{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}in\ \isacommand{using}\isamarkupfalse%
\ tips{\isacharunderscore}{\kern0pt}app\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}l{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ the{\isacharunderscore}{\kern0pt}map\isanewline
\ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}OrderDAG\ {\isacharparenleft}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}past\ G{\isacharunderscore}{\kern0pt}A\ a{\isacharparenright}{\kern0pt}\ k{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}avoid{\isacharunderscore}{\kern0pt}empty\ list{\isachardot}{\kern0pt}discI\ list{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}cases\ set{\isacharunderscore}{\kern0pt}ConsD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ bb{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ the{\isacharunderscore}{\kern0pt}map\isanewline
\ \ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{using}\isamarkupfalse%
\ \ Honest{\isacharunderscore}{\kern0pt}Append{\isacharunderscore}{\kern0pt}One{\isachardot}{\kern0pt}reduce{\isacharunderscore}{\kern0pt}append\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\ \isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}M\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}choose{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}set\ the{\isacharunderscore}{\kern0pt}map{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}anticone\ G{\isacharunderscore}{\kern0pt}A\ {\isacharparenleft}{\kern0pt}snd\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ c{\isacharunderscore}{\kern0pt}l\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ Honest{\isacharunderscore}{\kern0pt}Append{\isacharunderscore}{\kern0pt}One{\isachardot}{\kern0pt}append{\isacharunderscore}{\kern0pt}no{\isacharunderscore}{\kern0pt}anticone\ sndI\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ eml{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G{\isacharunderscore}{\kern0pt}A\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G{\isacharunderscore}{\kern0pt}A\ {\isacharparenleft}{\kern0pt}snd\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}empty\ top{\isacharunderscore}{\kern0pt}sort{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}fold\ {\isacharparenleft}{\kern0pt}app{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}blue{\isacharunderscore}{\kern0pt}else{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}end\ G\ k{\isacharparenright}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}top{\isacharunderscore}{\kern0pt}sort\ G{\isacharunderscore}{\kern0pt}A\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ {\isacharparenleft}{\kern0pt}anticone\ G{\isacharunderscore}{\kern0pt}A\ {\isacharparenleft}{\kern0pt}snd\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ bb\ \isacommand{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}\ snd\ {\isacharparenleft}{\kern0pt}add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple\ {\isacharquery}{\kern0pt}M{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}OrderDAG\ G\ k{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}\ {\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ bb\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}simps\ Pair{\isacharunderscore}{\kern0pt}inject\ add{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}tuple{\isachardot}{\kern0pt}elims\ snd{\isacharunderscore}{\kern0pt}conv\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ the{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}in\ \isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ OrderDAG{\isachardot}{\kern0pt}simps\ bD{\isacharunderscore}{\kern0pt}A\ g{\isadigit{1}}\ eml\ fold{\isacharunderscore}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{8}}{\isacharparenright}{\kern0pt}\ list{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{9}}{\isacharparenright}{\kern0pt}\ the{\isacharunderscore}{\kern0pt}map{\isacharunderscore}{\kern0pt}in\ tips{\isacharunderscore}{\kern0pt}app\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ \isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}k{\isachardot}{\kern0pt}\ Honest{\isacharunderscore}{\kern0pt}One{\isacharunderscore}{\kern0pt}Appending{\isacharunderscore}{\kern0pt}Monotone\ {\isacharparenleft}{\kern0pt}GHOSTDAG\ k{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ Honest{\isacharunderscore}{\kern0pt}One{\isacharunderscore}{\kern0pt}Appending{\isacharunderscore}{\kern0pt}Monotone{\isacharunderscore}{\kern0pt}def\ GHOSTDAG{\isachardot}{\kern0pt}simps\ \isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ list{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}rel{\isacharunderscore}{\kern0pt}mono\ OrderDAG{\isacharunderscore}{\kern0pt}append{\isacharunderscore}{\kern0pt}one\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=/cygdrive/c/repos/DAGModelling/Isabelle/Ghostdag_Properties.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%27=6%:%
%:%31=8%:%
%:%41=10%:%
%:%42=10%:%
%:%43=11%:%
%:%44=12%:%
%:%45=13%:%
%:%48=14%:%
%:%52=14%:%
%:%53=14%:%
%:%54=14%:%
%:%55=15%:%
%:%56=15%:%
%:%57=16%:%
%:%58=16%:%
%:%59=17%:%
%:%60=17%:%
%:%61=17%:%
%:%62=17%:%
%:%63=18%:%
%:%64=18%:%
%:%65=19%:%
%:%66=19%:%
%:%67=19%:%
%:%68=19%:%
%:%69=19%:%
%:%70=20%:%
%:%71=20%:%
%:%72=21%:%
%:%73=21%:%
%:%74=22%:%
%:%75=22%:%
%:%76=22%:%
%:%77=23%:%
%:%78=23%:%
%:%79=24%:%
%:%80=25%:%
%:%81=26%:%
%:%82=26%:%
%:%83=27%:%
%:%84=27%:%
%:%85=27%:%
%:%86=27%:%
%:%87=27%:%
%:%88=28%:%
%:%89=28%:%
%:%90=29%:%
%:%91=29%:%
%:%92=30%:%
%:%93=30%:%
%:%94=31%:%
%:%95=31%:%
%:%96=31%:%
%:%97=32%:%
%:%98=32%:%
%:%101=35%:%
%:%102=36%:%
%:%103=36%:%
%:%104=37%:%
%:%105=37%:%
%:%106=38%:%
%:%107=38%:%
%:%108=39%:%
%:%109=39%:%
%:%110=40%:%
%:%111=40%:%
%:%112=40%:%
%:%113=41%:%
%:%114=41%:%
%:%115=41%:%
%:%116=42%:%
%:%117=42%:%
%:%118=42%:%
%:%119=42%:%
%:%120=43%:%
%:%121=43%:%
%:%122=44%:%
%:%123=44%:%
%:%124=44%:%
%:%125=45%:%
%:%126=45%:%
%:%127=46%:%
%:%128=46%:%
%:%129=47%:%
%:%130=47%:%
%:%131=47%:%
%:%132=47%:%
%:%133=47%:%
%:%134=48%:%
%:%135=49%:%
%:%136=49%:%
%:%137=50%:%
%:%138=50%:%
%:%139=50%:%
%:%140=51%:%
%:%141=51%:%
%:%142=51%:%
%:%143=52%:%
%:%144=52%:%
%:%145=53%:%
%:%146=53%:%
%:%147=54%:%
%:%148=55%:%
%:%149=56%:%
%:%150=56%:%
%:%151=57%:%
%:%152=57%:%
%:%153=57%:%
%:%154=57%:%
%:%155=58%:%
%:%156=58%:%
%:%157=59%:%
%:%158=59%:%
%:%159=59%:%
%:%160=59%:%
%:%161=60%:%
%:%162=61%:%
%:%163=61%:%
%:%164=62%:%
%:%165=62%:%
%:%166=62%:%
%:%167=63%:%
%:%168=63%:%
%:%169=64%:%
%:%170=64%:%
%:%171=64%:%
%:%172=65%:%
%:%173=65%:%
%:%174=65%:%
%:%175=66%:%
%:%176=66%:%
%:%177=67%:%
%:%178=67%:%
%:%179=68%:%
%:%180=68%:%
%:%181=69%:%
%:%182=69%:%
%:%183=69%:%
%:%184=70%:%
%:%185=70%:%
%:%186=70%:%
%:%187=70%:%
%:%188=71%:%
%:%189=71%:%
%:%190=71%:%
%:%191=72%:%
%:%192=72%:%
%:%193=73%:%
%:%194=73%:%
%:%195=74%:%
%:%196=75%:%
%:%197=75%:%
%:%198=76%:%
%:%199=76%:%
%:%200=77%:%
%:%201=77%:%
%:%202=77%:%
%:%203=78%:%
%:%204=78%:%
%:%205=79%:%
%:%206=79%:%
%:%207=80%:%
%:%208=80%:%
%:%209=81%:%
%:%210=81%:%
%:%211=82%:%
%:%212=82%:%
%:%213=82%:%
%:%214=83%:%
%:%215=83%:%
%:%216=83%:%
%:%217=84%:%
%:%218=85%:%
%:%219=85%:%
%:%220=86%:%
%:%221=86%:%
%:%222=86%:%
%:%223=87%:%
%:%224=87%:%
%:%225=87%:%
%:%226=88%:%
%:%227=88%:%
%:%228=89%:%
%:%229=89%:%
%:%230=89%:%
%:%231=90%:%
%:%232=91%:%
%:%233=92%:%
%:%234=92%:%
%:%235=93%:%
%:%236=93%:%
%:%237=93%:%
%:%238=93%:%
%:%239=94%:%
%:%240=94%:%
%:%241=95%:%
%:%242=95%:%
%:%243=95%:%
%:%244=96%:%
%:%245=96%:%
%:%246=97%:%
%:%247=97%:%
%:%248=98%:%
%:%249=98%:%
%:%250=99%:%
%:%251=99%:%
%:%252=99%:%
%:%253=99%:%
%:%254=100%:%
%:%255=100%:%
%:%256=101%:%
%:%257=101%:%
%:%258=102%:%
%:%259=102%:%
%:%260=103%:%
%:%261=103%:%
%:%262=104%:%
%:%263=104%:%
%:%264=105%:%
%:%265=105%:%
%:%266=105%:%
%:%267=106%:%
%:%268=106%:%
%:%269=107%:%
%:%270=107%:%
%:%271=108%:%
%:%272=108%:%
%:%273=108%:%
%:%274=109%:%
%:%275=109%:%
%:%276=110%:%
%:%277=110%:%
%:%278=111%:%
%:%279=111%:%
%:%280=111%:%
%:%281=111%:%
%:%282=112%:%
%:%283=112%:%
%:%284=113%:%
%:%285=113%:%
%:%286=114%:%
%:%287=114%:%
%:%288=115%:%
%:%289=115%:%
%:%290=116%:%
%:%291=116%:%
%:%292=116%:%
%:%293=116%:%
%:%294=116%:%
%:%295=117%:%
%:%296=118%:%
%:%297=118%:%
%:%298=119%:%
%:%299=119%:%
%:%300=119%:%
%:%301=119%:%
%:%302=119%:%
%:%303=120%:%
%:%304=120%:%
%:%305=121%:%
%:%306=121%:%
%:%307=122%:%
%:%308=122%:%
%:%309=122%:%
%:%310=123%:%
%:%311=124%:%
%:%312=125%:%
%:%313=125%:%
%:%314=126%:%
%:%315=126%:%
%:%316=126%:%
%:%317=126%:%
%:%318=127%:%
%:%319=127%:%
%:%320=128%:%
%:%321=128%:%
%:%322=128%:%
%:%323=129%:%
%:%324=129%:%
%:%325=130%:%
%:%326=130%:%
%:%327=131%:%
%:%328=131%:%
%:%329=131%:%
%:%330=131%:%
%:%331=131%:%
%:%332=132%:%
%:%333=132%:%
%:%334=133%:%
%:%335=133%:%
%:%336=134%:%
%:%337=134%:%
%:%338=135%:%
%:%339=135%:%
%:%340=136%:%
%:%341=136%:%
%:%342=136%:%
%:%343=137%:%
%:%344=137%:%
%:%345=137%:%
%:%346=138%:%
%:%347=139%:%
%:%348=139%:%
%:%349=140%:%
%:%350=140%:%
%:%351=140%:%
%:%352=140%:%
%:%353=140%:%
%:%354=141%:%
%:%355=141%:%
%:%356=141%:%
%:%357=141%:%
%:%358=142%:%
%:%359=142%:%
%:%360=143%:%
%:%361=143%:%
%:%362=144%:%
%:%363=144%:%
%:%364=145%:%
%:%365=145%:%
%:%366=145%:%
%:%367=146%:%
%:%368=146%:%
%:%369=147%:%
%:%370=147%:%
%:%371=148%:%
%:%372=148%:%
%:%373=148%:%
%:%374=148%:%
%:%375=148%:%
%:%376=149%:%
%:%377=150%:%
%:%378=150%:%
%:%379=151%:%
%:%380=151%:%
%:%381=152%:%
%:%382=152%:%
%:%383=153%:%
%:%384=153%:%
%:%385=154%:%
%:%391=154%:%
%:%394=155%:%
%:%395=156%:%
%:%396=157%:%
%:%397=157%:%
%:%400=158%:%
%:%404=158%:%
%:%405=158%:%
%:%406=159%:%
%:%407=159%:%
%:%408=160%:%
%:%409=160%:%
%:%423=164%:%
%:%433=168%:%
%:%434=168%:%
%:%435=169%:%
%:%436=170%:%
%:%439=171%:%
%:%443=171%:%
%:%444=171%:%
%:%445=172%:%
%:%446=172%:%
%:%447=172%:%
%:%452=172%:%
%:%455=173%:%
%:%456=174%:%
%:%457=174%:%
%:%460=175%:%
%:%464=175%:%
%:%465=175%:%
%:%466=176%:%
%:%467=176%:%
%:%468=176%:%
%:%482=179%:%
%:%492=181%:%
%:%493=181%:%
%:%494=182%:%
%:%495=183%:%
%:%502=184%:%
%:%503=184%:%
%:%504=185%:%
%:%505=185%:%
%:%506=185%:%
%:%507=186%:%
%:%508=186%:%
%:%509=187%:%
%:%510=187%:%
%:%511=188%:%
%:%512=188%:%
%:%513=189%:%
%:%514=189%:%
%:%515=190%:%
%:%516=190%:%
%:%517=190%:%
%:%518=190%:%
%:%519=191%:%
%:%520=191%:%
%:%521=191%:%
%:%522=191%:%
%:%523=192%:%
%:%524=192%:%
%:%525=193%:%
%:%526=194%:%
%:%527=194%:%
%:%528=195%:%
%:%529=195%:%
%:%530=195%:%
%:%531=196%:%
%:%532=196%:%
%:%533=196%:%
%:%534=196%:%
%:%535=197%:%
%:%536=197%:%
%:%537=197%:%
%:%538=198%:%
%:%539=199%:%
%:%540=199%:%
%:%541=200%:%
%:%542=200%:%
%:%543=200%:%
%:%544=201%:%
%:%545=201%:%
%:%546=202%:%
%:%547=202%:%
%:%548=203%:%
%:%549=203%:%
%:%550=204%:%
%:%551=204%:%
%:%552=205%:%
%:%553=205%:%
%:%554=206%:%
%:%555=206%:%
%:%556=207%:%
%:%557=207%:%
%:%558=208%:%
%:%559=208%:%
%:%560=208%:%
%:%561=209%:%
%:%562=209%:%
%:%563=210%:%
%:%564=210%:%
%:%565=210%:%
%:%567=212%:%
%:%568=213%:%
%:%569=213%:%
%:%570=213%:%
%:%571=214%:%
%:%572=214%:%
%:%573=214%:%
%:%574=215%:%
%:%575=215%:%
%:%576=216%:%
%:%577=216%:%
%:%578=217%:%
%:%579=217%:%
%:%580=218%:%
%:%581=218%:%
%:%582=218%:%
%:%583=219%:%
%:%584=219%:%
%:%585=220%:%
%:%586=220%:%
%:%587=221%:%
%:%588=221%:%
%:%589=222%:%
%:%595=222%:%
%:%598=223%:%
%:%599=224%:%
%:%600=224%:%
%:%603=225%:%
%:%607=225%:%
%:%608=225%:%
%:%609=226%:%
%:%610=226%:%
%:%611=227%:%
%:%612=227%:%
%:%617=227%:%
%:%622=228%:%
%:%627=229%:%